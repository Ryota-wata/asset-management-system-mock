<!-- 資産管理台帳と資産マスタ突き合わせ画面（フラットテーブル形式） -->
<div id="assetMatchingPage" class="asset-matching-page">
    <div class="main-container-matching">
        <!-- ヘッダー -->
        <header class="header-matching">
            <div class="header-left-matching">
                <h1 class="header-title-matching">資産台帳とマスタの突き合わせ</h1>
            </div>
            <div class="header-right-matching">
                <div class="progress-info-matching">
                    <span class="progress-label-matching">進捗:</span>
                    <span class="progress-value-matching" id="progressCount">0 / 30</span>
                    <span class="progress-separator-matching">|</span>
                    <span class="completed-label-matching">完了:</span>
                    <span class="completed-value-matching" id="completedCount">0件</span>
                </div>
            </div>
        </header>

        <!-- フィルターバー -->
        <div class="filter-bar-matching">
            <div class="filter-buttons-matching">
                <button class="filter-btn-matching active" onclick="filterMatchingData('all')" data-filter="all">
                    すべて <span class="filter-count-matching">(30)</span>
                </button>
                <button class="filter-btn-matching" onclick="filterMatchingData('pending')" data-filter="pending">
                    未処理 <span class="filter-count-matching">(30)</span>
                </button>
                <button class="filter-btn-matching" onclick="filterMatchingData('completed')" data-filter="completed">
                    済 <span class="filter-count-matching">(0)</span>
                </button>
            </div>
            <div class="bulk-actions-matching">
                <button class="bulk-action-btn-matching" onclick="bulkConfirmSelected()">
                    <span>✓</span>
                    <span>選択項目を一括確定</span>
                </button>
                <button class="master-view-btn-matching" onclick="openAssetMasterWindow()">
                    <span>📋</span>
                    <span>資産マスタを別ウィンドウで開く</span>
                </button>
            </div>
        </div>

        <!-- メインコンテンツ -->
        <main class="main-content-matching">
            <div class="search-area-matching">
                <input type="text" class="search-input-full-matching" placeholder="資産番号、品名で検索..."
                       onkeyup="searchImportData(this.value)">
            </div>

            <div class="table-wrapper-matching">
                <table class="matching-table-flat">
                    <thead>
                        <tr>
                            <th class="th-checkbox-matching">
                                <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll(this)">
                            </th>
                            <th class="th-no-matching">No.</th>
                            <!-- 固定資産台帳カラム -->
                            <th class="th-col-group-matching" colspan="7">固定資産台帳データ</th>
                            <!-- AI推薦1 -->
                            <th class="th-col-group-matching" colspan="7">AI推薦1</th>
                            <!-- AI推薦2 -->
                            <th class="th-col-group-matching" colspan="7">AI推薦2</th>
                            <!-- AI推薦3 -->
                            <th class="th-col-group-matching" colspan="7">AI推薦3</th>
                            <!-- 操作 -->
                            <th class="th-actions-matching" colspan="2">操作</th>
                        </tr>
                        <tr class="sub-header-row">
                            <th></th>
                            <th></th>
                            <!-- 固定資産台帳サブヘッダー -->
                            <th class="th-sub-matching">資産番号</th>
                            <th class="th-sub-matching">登録品目名</th>
                            <th class="th-sub-matching">メーカー名</th>
                            <th class="th-sub-matching">型式</th>
                            <th class="th-sub-matching">大分類</th>
                            <th class="th-sub-matching">中分類</th>
                            <th class="th-sub-matching">個体管理品目</th>
                            <!-- AI推薦1サブヘッダー -->
                            <th class="th-sub-matching th-select-matching">選択</th>
                            <th class="th-sub-matching">類似度</th>
                            <th class="th-sub-matching">大分類</th>
                            <th class="th-sub-matching">中分類</th>
                            <th class="th-sub-matching">個体管理品目</th>
                            <th class="th-sub-matching">メーカー名</th>
                            <th class="th-sub-matching">型式</th>
                            <!-- AI推薦2サブヘッダー -->
                            <th class="th-sub-matching th-select-matching">選択</th>
                            <th class="th-sub-matching">類似度</th>
                            <th class="th-sub-matching">大分類</th>
                            <th class="th-sub-matching">中分類</th>
                            <th class="th-sub-matching">個体管理品目</th>
                            <th class="th-sub-matching">メーカー名</th>
                            <th class="th-sub-matching">型式</th>
                            <!-- AI推薦3サブヘッダー -->
                            <th class="th-sub-matching th-select-matching">選択</th>
                            <th class="th-sub-matching">類似度</th>
                            <th class="th-sub-matching">大分類</th>
                            <th class="th-sub-matching">中分類</th>
                            <th class="th-sub-matching">個体管理品目</th>
                            <th class="th-sub-matching">メーカー名</th>
                            <th class="th-sub-matching">型式</th>
                            <!-- 操作サブヘッダー -->
                            <th class="th-sub-matching">編集</th>
                            <th class="th-sub-matching">確定</th>
                        </tr>
                    </thead>
                    <tbody id="matchingTableBody">
                        <!-- サンプルデータ行1 -->
                        <tr class="data-row-flat" data-index="0" data-status="pending">
                            <td class="td-checkbox-matching">
                                <input type="checkbox" class="row-checkbox" data-index="0">
                            </td>
                            <td class="td-no-matching">1</td>
                            <!-- 固定資産台帳データ -->
                            <td class="td-data-matching"><span class="cell-value" data-field="assetNo">A-001-2023</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="productName">MRI装置 シーメンス MAGNETOM</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="manufacturer">シーメンスヘルスケア</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="model">MAGNETOM Vida 3T</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="majorCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="middleCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="itemManagement"></span></td>
                            <!-- AI推薦1 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-0" class="ai-select-radio" value="rec1" checked onchange="selectAIRecommendation(0, 1)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching high">98%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_middle">画像診断装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_item">MRI装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_mfr">シーメンスヘルスケア</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_model">MAGNETOM Vida 3T</span></td>
                            <!-- AI推薦2 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-0" class="ai-select-radio" value="rec2" onchange="selectAIRecommendation(0, 2)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching medium">85%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_middle">画像診断装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_item">MRI装置（汎用）</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_mfr">シーメンス</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_model">MAGNETOMシリーズ</span></td>
                            <!-- AI推薦3 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-0" class="ai-select-radio" value="rec3" onchange="selectAIRecommendation(0, 3)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching low">72%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_middle">診断機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_item">磁気共鳴画像診断装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_mfr">その他</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_model">不明</span></td>
                            <!-- 操作 -->
                            <td class="td-action-matching">
                                <button class="edit-btn-flat" onclick="toggleEditMode(0)">編集</button>
                            </td>
                            <td class="td-action-matching">
                                <button class="confirm-btn-flat" onclick="confirmRowFlat(0)">確定</button>
                            </td>
                        </tr>

                        <!-- サンプルデータ行2 -->
                        <tr class="data-row-flat" data-index="1" data-status="pending">
                            <td class="td-checkbox-matching">
                                <input type="checkbox" class="row-checkbox" data-index="1">
                            </td>
                            <td class="td-no-matching">2</td>
                            <!-- 固定資産台帳データ -->
                            <td class="td-data-matching"><span class="cell-value" data-field="assetNo">A-002-2023</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="productName">CT装置 GE Healthcare Revolution</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="manufacturer">GEヘルスケア</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="model">Revolution CT</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="majorCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="middleCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="itemManagement"></span></td>
                            <!-- AI推薦1 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-1" class="ai-select-radio" value="rec1" checked onchange="selectAIRecommendation(1, 1)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching high">95%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_middle">画像診断装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_item">CT装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_mfr">GEヘルスケア</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_model">Revolution CT</span></td>
                            <!-- AI推薦2 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-1" class="ai-select-radio" value="rec2" onchange="selectAIRecommendation(1, 2)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching medium">88%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_middle">画像診断装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_item">CT装置（汎用）</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_mfr">GE</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_model">Revolution シリーズ</span></td>
                            <!-- AI推薦3 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-1" class="ai-select-radio" value="rec3" onchange="selectAIRecommendation(1, 3)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching low">75%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_middle">診断機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_item">コンピュータ断層撮影装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_mfr">その他</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_model">不明</span></td>
                            <!-- 操作 -->
                            <td class="td-action-matching">
                                <button class="edit-btn-flat" onclick="toggleEditMode(1)">編集</button>
                            </td>
                            <td class="td-action-matching">
                                <button class="confirm-btn-flat" onclick="confirmRowFlat(1)">確定</button>
                            </td>
                        </tr>

                        <!-- サンプルデータ行3 -->
                        <tr class="data-row-flat" data-index="2" data-status="pending">
                            <td class="td-checkbox-matching">
                                <input type="checkbox" class="row-checkbox" data-index="2">
                            </td>
                            <td class="td-no-matching">3</td>
                            <!-- 固定資産台帳データ -->
                            <td class="td-data-matching"><span class="cell-value" data-field="assetNo">A-003-2023</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="productName">人工呼吸器 ドレーゲル Savina</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="manufacturer">ドレーゲル</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="model">Savina 300</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="majorCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="middleCategory"></span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="itemManagement"></span></td>
                            <!-- AI推薦1 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-2" class="ai-select-radio" value="rec1" checked onchange="selectAIRecommendation(2, 1)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching medium">88%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_middle">生命維持装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_item">人工呼吸器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_mfr">ドレーゲル</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai1_model">Savina 300</span></td>
                            <!-- AI推薦2 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-2" class="ai-select-radio" value="rec2" onchange="selectAIRecommendation(2, 2)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching medium">82%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_middle">生命維持装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_item">人工呼吸器（汎用）</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_mfr">ドレーゲル</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai2_model">Savinaシリーズ</span></td>
                            <!-- AI推薦3 -->
                            <td class="td-select-matching">
                                <input type="radio" name="ai-select-2" class="ai-select-radio" value="rec3" onchange="selectAIRecommendation(2, 3)">
                            </td>
                            <td class="td-similarity-matching"><span class="similarity-badge-matching low">70%</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_major">医療機器</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_middle">呼吸器系装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_item">呼吸補助装置</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_mfr">その他</span></td>
                            <td class="td-data-matching"><span class="cell-value" data-field="ai3_model">不明</span></td>
                            <!-- 操作 -->
                            <td class="td-action-matching">
                                <button class="edit-btn-flat" onclick="toggleEditMode(2)">編集</button>
                            </td>
                            <td class="td-action-matching">
                                <button class="confirm-btn-flat" onclick="confirmRowFlat(2)">確定</button>
                            </td>
                        </tr>

                        <!-- 残り27件のサンプルデータは省略（実際は30件必要） -->
                    </tbody>
                </table>
            </div>

            <!-- ページネーション -->
            <div class="pagination-area-matching">
                <button class="pagination-btn-matching" onclick="goToPreviousPage()">← 前へ</button>
                <span class="pagination-info-matching">1 - 30 / 30</span>
                <button class="pagination-btn-matching" onclick="goToNextPage()">次へ →</button>
            </div>
        </main>

        <!-- フッター -->
        <footer class="footer-matching">
            <button class="footer-btn-matching secondary" onclick="handleBackFromMatching()">
                <span>←</span>
                <span>戻る</span>
            </button>
            <button class="footer-btn-matching primary" onclick="completeMatching()">
                <span>突き合わせ完了</span>
            </button>
        </footer>
    </div>
</div>
