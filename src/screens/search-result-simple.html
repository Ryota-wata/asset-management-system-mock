<!-- 資産検索結果画面 - 完全版 -->
<div id="searchResultPage" class="search-result-page">

    <div class="result-container">
        <!-- ヘッダー -->
        <header class="result-header">
            <div class="result-header-left">
                <div class="logo">
                    <div class="logo-icon">SHIP</div>
                    <div class="result-header-title">資産リスト</div>
                </div>
                <span class="result-count">20件（原本）</span>
            </div>
            <div class="result-header-actions">
                <div class="nav-menu">
                    <button class="nav-menu-btn" onclick="toggleNavMenu()">
                        <span>📑 メニュー</span>
                        <span class="nav-menu-arrow">▼</span>
                    </button>
                    <div class="nav-menu-dropdown" id="navMenuDropdown">
                        <div class="nav-menu-item" onclick="goToApplicationList()">
                            <span class="nav-menu-item-icon">📝</span>
                            <span>申請一覧</span>
                        </div>
                        <div class="nav-menu-item" onclick="goToQuotationDataBox()">
                            <span class="nav-menu-item-icon">📦</span>
                            <span>見積書管理</span>
                        </div>
                    </div>
                </div>
                <button class="header-icon-btn" id="viewToggleBtn" onclick="toggleView()" title="表示切替">
                    📋
                </button>
                <button class="header-icon-btn" id="exportBtn" onclick="handleExport()" title="Excel/PDF出力">
                    📊
                </button>
                <button class="header-icon-btn" onclick="handlePrint()" title="印刷">
                    🖨️
                </button>
                <button class="header-btn back" onclick="handleBack()">戻る</button>
            </div>
        </header>

        <!-- フィルターヘッダー -->
        <div class="filter-header">
            <div class="filter-row-single">
                <div class="filter-group">
                    <label>棟</label>
                    <select id="filterBuilding" class="filter-select">
                        <option value="">すべて</option>
                        <option value="本館">本館</option>
                        <option value="別館">別館</option>
                        <option value="新館">新館</option>
                        <option value="研究棟">研究棟</option>
                        <option value="管理棟">管理棟</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>階</label>
                    <select id="filterFloor" class="filter-select">
                        <option value="">すべて</option>
                        <option value="B1F">B1F</option>
                        <option value="1F">1F</option>
                        <option value="2F">2F</option>
                        <option value="3F">3F</option>
                        <option value="4F">4F</option>
                        <option value="5F">5F</option>
                        <option value="6F">6F</option>
                        <option value="7F">7F</option>
                        <option value="8F">8F</option>
                        <option value="9F">9F</option>
                        <option value="10F">10F</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>部門</label>
                    <select id="filterDepartment" class="filter-select">
                        <option value="">すべて</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>部署</label>
                    <select id="filterSection" class="filter-select">
                        <option value="">すべて</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Category</label>
                    <select id="filterCategory" class="filter-select">
                        <option value="">すべて</option>
                        <option value="医療機器">医療機器</option>
                        <option value="什器備品">什器備品</option>
                        <option value="車両">車両</option>
                        <option value="建物">建物</option>
                        <option value="その他">その他</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>大分類</label>
                    <select id="filterLargeClass" class="filter-select">
                        <option value="">すべて</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>中分類</label>
                    <select id="filterMediumClass" class="filter-select">
                        <option value="">すべて</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- アクションバー -->
        <div class="action-bar">
            <span class="selection-info" id="selectionInfo">0件選択中</span>

            <!-- 新規購入申請（資産マスタから選択） -->
            <button class="action-btn new-purchase-action" onclick="handleNewPurchaseRequest()">
                新規購入申請
            </button>

            <!-- 既存資産ベースの申請（資産選択必須） -->
            <button class="action-btn expansion-action" id="expansionBtn" onclick="handleExpansionRequest()" disabled>
                増設購入申請
            </button>

            <button class="action-btn renewal-action" id="renewalBtn" onclick="handleRenewalRequest()" disabled>
                更新購入申請
            </button>

            <!-- その他の機能 -->
            <button class="action-btn inventory-action" id="inventoryBtn" onclick="handleInventory()" disabled>
                資産棚卸し
            </button>
        </div>

        <!-- メインコンテンツエリア -->
        <div class="main-content-area">
            <div class="content-wrapper">
                <!-- テーブル表示 -->
                <div class="list-view" id="listView">
                    <table class="resizable-table data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll" onchange="handleSelectAll()"></th>
                                <th>No.</th>
                                <th>施設名</th>
                                <th>棟</th>
                                <th>階</th>
                                <th>部門</th>
                                <th>部署</th>
                                <th>Category</th>
                                <th>大分類</th>
                                <th>中分類</th>
                                <th>品目</th>
                                <th>品名</th>
                                <th>メーカー</th>
                                <th>型式</th>
                                <th>数量</th>
                                <th>幅(W)</th>
                                <th>奥行(D)</th>
                                <th>高さ(H)</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- データ行はJavaScriptで生成 -->
                        </tbody>
                    </table>
                </div>

                <!-- カード表示 -->
                <div class="card-view" id="cardView">
                    <!-- カードはJavaScriptで生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Excel/PDF出力モーダル -->
    <div class="modal" id="exportModal" onclick="handleExportModalOutsideClick(event)">
        <div class="modal-content">
            <h2 class="modal-title" id="exportModalTitle">Excel出力項目の選択</h2>
            <div class="modal-option" onclick="selectExportTemplate('default')">
                <div class="modal-option-label">出力テンプレート</div>
                <div class="modal-option-desc">登録済の出力項目を選択</div>
            </div>
            <div class="modal-option" onclick="selectExportTemplate('bookmark')">
                <div class="modal-option-label">ブックマーク</div>
                <div class="modal-option-desc">任意の登録済のテンプレートを選択</div>
            </div>
            <button class="modal-button" onclick="executeExport()">この条件でExcel出力</button>
            <button class="modal-button secondary" onclick="selectCustomColumns()">任意項目選択</button>
            <button class="modal-button secondary" onclick="closeExportModal()">キャンセル</button>
        </div>
    </div>

    <!-- 資産マスタ検索モーダル（新規購入用） -->
    <div class="modal" id="assetMasterModal" onclick="handleModalOutsideClick(event)">
        <div class="modal-content">
            <h2 class="modal-title">資産マスタから選択（新規購入申請）</h2>

            <!-- 検索フォーム -->
            <div style="margin-bottom: 20px; background: #f8f9fa; padding: 15px; border-radius: 4px;">
                <h4 style="font-size: 13px; color: #2c3e50; margin-bottom: 10px; font-weight: bold;">📋 プルダウン検索</h4>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                    <div id="categoryWrapper" style="position: relative; z-index: 100008;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">Category</label>
                        <select id="masterCategory" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                    <div id="largeClassWrapper" style="position: relative; z-index: 100007;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">大分類</label>
                        <select id="masterLargeClass" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                    <div id="mediumClassWrapper" style="position: relative; z-index: 100006;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">中分類</label>
                        <select id="masterMediumClass" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                    <div id="individualItemWrapper" style="position: relative; z-index: 100005;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">個体管理品目</label>
                        <select id="masterIndividualItem" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                    <div id="makerWrapper" style="position: relative; z-index: 100004;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">メーカー</label>
                        <select id="masterMaker" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                    <div id="modelWrapper" style="position: relative; z-index: 100003;">
                        <label style="font-size: 12px; color: #555; margin-bottom: 5px; display: block;">型式</label>
                        <select id="masterModel" class="master-filter-select" onchange="filterAssetMasterTable()">
                            <option value="">全て</option>
                        </select>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button class="modal-button secondary" onclick="resetMasterFilter()" style="flex: 1;">
                        🔄 クリア
                    </button>
                    <button class="modal-button" onclick="addSelectedAssetFromDropdowns()" style="flex: 2; background: #27ae60; color: white;">
                        ➕ 選択リストに追加
                    </button>
                </div>
            </div>

            <!-- 選択済み資産と数量設定 -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">📦 選択済み資産・数量設定 <span class="required">*</span></div>
                <div id="assetQuantityForm">
                    <p style="color: #999; text-align: center; padding: 20px;">資産が選択されていません</p>
                </div>
            </div>

            <!-- 設置情報 -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">🏥 設置情報（任意）</div>
                <div class="form-grid">
                    <div class="application-form-group">
                        <label>棟</label>
                        <select id="building" onchange="updateDepartmentOptions()">
                            <option value="">選択してください</option>
                        </select>
                    </div>
                    <div class="application-form-group">
                        <label>部門</label>
                        <select id="division" onchange="updateSectionOptions()">
                            <option value="">選択してください</option>
                        </select>
                    </div>
                    <div class="application-form-group">
                        <label>部署</label>
                        <select id="section" onchange="updateRoomRangeOptions()">
                            <option value="">選択してください</option>
                        </select>
                    </div>
                    <div class="application-form-group">
                        <label>諸室名範囲</label>
                        <select id="roomRange">
                            <option value="">選択してください</option>
                        </select>
                    </div>
                    <div class="application-form-group" style="grid-column: 1 / -1;">
                        <label>諸室名（自由入力可）</label>
                        <input type="text" id="roomName" placeholder="諸室名を入力">
                    </div>
                </div>
            </div>

            <!-- その他情報（任意） -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">📝 その他情報（任意）</div>
                <div class="application-form-group">
                    <label>フリー入力（申請理由・コメント等）</label>
                    <textarea id="freeInput" placeholder="申請時のコメントや理由などを入力してください" rows="3"></textarea>
                </div>
                <div class="application-form-group">
                    <label>執行年度</label>
                    <select id="executionYear">
                        <option value="">選択してください</option>
                        <option value="2024">2024年度</option>
                        <option value="2025">2025年度</option>
                        <option value="2026">2026年度</option>
                        <option value="2024-2025">2024～2025年度</option>
                        <option value="2025-2026">2025～2026年度</option>
                    </select>
                </div>
            </div>

            <!-- システム関連情報（任意） -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">💻 システム関連情報（任意）</div>
                <div class="system-info-grid">
                    <div class="system-info-label">現状の接続状況</div>
                    <div class="system-info-fields">
                        <label class="radio-label">
                            <input type="radio" name="currentConnection" value="yes"> 接続あり
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="currentConnection" value="no" checked> 接続なし
                        </label>
                    </div>

                    <div class="system-info-label">現状の接続先</div>
                    <div class="system-info-fields">
                        <input type="text" id="currentConnectionTarget" placeholder="部門システム名を入力">
                    </div>

                    <div class="system-info-label">要望機器の接続要望</div>
                    <div class="system-info-fields">
                        <label class="radio-label">
                            <input type="radio" name="requestConnection" value="yes"> 接続希望
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="requestConnection" value="no" checked> 接続不要
                        </label>
                    </div>

                    <div class="system-info-label">要望機器の接続先</div>
                    <div class="system-info-fields">
                        <input type="text" id="requestConnectionTarget" placeholder="部門システム名を入力">
                    </div>
                </div>
            </div>

            <!-- ボタンエリア -->
            <div style="display: flex; gap: 10px;">
                <button class="modal-button secondary" onclick="closeAssetMasterModal()" style="flex: 1;">キャンセル</button>
                <button class="modal-button" onclick="submitApplication()" style="flex: 2; background: #27ae60; color: white;">申請を確定</button>
            </div>
        </div>
    </div>

    <!-- 増設購入申請モーダル -->
    <div class="modal" id="expansionRequestModal" onclick="handleModalOutsideClick(event)">
        <div class="modal-content" style="max-width: 1000px;">
            <h2 class="modal-title">増設購入申請</h2>

            <!-- 選択済み資産 -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">📦 対象資産 <span class="required">*</span></div>
                <div id="expansionAssetList" style="background: #f8f9fa; padding: 15px; border-radius: 4px; max-height: 200px; overflow-y: auto;">
                    <!-- JavaScriptで生成 -->
                </div>
            </div>

            <!-- 数量設定 -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">📋 数量設定 <span class="required">*</span></div>
                <div id="expansionQuantityForm" style="max-height: 300px; overflow-y: auto;">
                    <!-- JavaScriptで生成 -->
                </div>
            </div>

            <!-- 設置情報 -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">🏥 設置情報（任意）</div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">
                    <div class="form-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div class="application-form-group">
                            <label>棟</label>
                            <select id="expansionBuilding" onchange="updateExpansionDepartmentOptions()">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                        <div class="application-form-group">
                            <label>部門</label>
                            <select id="expansionDivision" onchange="updateExpansionSectionOptions()">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                        <div class="application-form-group">
                            <label>部署</label>
                            <select id="expansionSection" onchange="updateExpansionRoomRangeOptions()">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                        <div class="application-form-group">
                            <label>諸室名範囲</label>
                            <select id="expansionRoomRange">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                        <div class="application-form-group" style="grid-column: 1 / -1;">
                            <label>諸室名（自由入力可）</label>
                            <input type="text" id="expansionRoomName" placeholder="諸室名を入力">
                        </div>
                    </div>
                </div>
            </div>

            <!-- その他情報（任意） -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">📝 その他情報（任意）</div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">
                    <div class="application-form-group" style="margin-bottom: 15px;">
                        <label>フリー入力（申請理由・コメント等）</label>
                        <textarea id="expansionFreeInput" placeholder="増設理由や設置場所の詳細などを入力してください" rows="3" style="width: 100%;"></textarea>
                    </div>
                    <div class="application-form-group">
                        <label>執行年度</label>
                        <select id="expansionExecutionYear" style="width: 250px;">
                            <option value="">選択してください</option>
                            <option value="2024">2024年度</option>
                            <option value="2025">2025年度</option>
                            <option value="2026">2026年度</option>
                            <option value="2024-2025">2024～2025年度</option>
                            <option value="2025-2026">2025～2026年度</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- システム関連情報（任意） -->
            <div class="application-section" style="margin-bottom: 20px;">
                <div class="application-section-title">💻 システム関連情報（任意）</div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">
                    <div class="system-info-grid">
                        <div class="system-info-label">現状の接続状況</div>
                        <div class="system-info-fields">
                            <label class="radio-label">
                                <input type="radio" name="expansionCurrentConnection" value="yes"> 接続あり
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="expansionCurrentConnection" value="no" checked> 接続なし
                            </label>
                        </div>

                        <div class="system-info-label">現状の接続先</div>
                        <div class="system-info-fields">
                            <input type="text" id="expansionCurrentConnectionTarget" placeholder="部門システム名を入力">
                        </div>

                        <div class="system-info-label">要望機器の接続要望</div>
                        <div class="system-info-fields">
                            <label class="radio-label">
                                <input type="radio" name="expansionRequestConnection" value="yes"> 接続希望
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="expansionRequestConnection" value="no" checked> 接続不要
                            </label>
                        </div>

                        <div class="system-info-label">要望機器の接続先</div>
                        <div class="system-info-fields">
                            <input type="text" id="expansionRequestConnectionTarget" placeholder="部門システム名を入力">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ボタンエリア -->
            <div style="display: flex; gap: 10px;">
                <button class="modal-button secondary" onclick="closeExpansionRequestModal()" style="flex: 1;">キャンセル</button>
                <button class="modal-button" onclick="submitExpansionApplication()" style="flex: 2; background: #27ae60; color: white;">申請を確定</button>
            </div>
        </div>
    </div>

    <!-- 右サイドパネル（行表示項目選択） -->
    <div class="side-panel" id="sidePanel">
        <div class="side-panel-header">
            Excel出力項目（行）の選択
        </div>
        <div class="side-panel-content">
            <div class="panel-section">
                <div class="panel-section-title">基本情報</div>
                <div class="panel-item">
                    <input type="checkbox" id="col_facility" checked>
                    <label for="col_facility">施設名</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_building" checked>
                    <label for="col_building">棟</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_floor" checked>
                    <label for="col_floor">階</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_department" checked>
                    <label for="col_department">部門</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_section" checked>
                    <label for="col_section">部署</label>
                </div>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title">分類情報</div>
                <div class="panel-item">
                    <input type="checkbox" id="col_category" checked>
                    <label for="col_category">Category</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_large" checked>
                    <label for="col_large">大分類</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_medium" checked>
                    <label for="col_medium">中分類</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_item" checked>
                    <label for="col_item">品目</label>
                </div>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title">製品情報</div>
                <div class="panel-item">
                    <input type="checkbox" id="col_name" checked>
                    <label for="col_name">品名</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_maker" checked>
                    <label for="col_maker">メーカー</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_model" checked>
                    <label for="col_model">型式</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_quantity" checked>
                    <label for="col_quantity">数量</label>
                </div>
            </div>
            
            <div class="panel-section">
                <div class="panel-section-title">寸法情報</div>
                <div class="panel-item">
                    <input type="checkbox" id="col_width" checked>
                    <label for="col_width">幅(W)</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_depth" checked>
                    <label for="col_depth">奥行(D)</label>
                </div>
                <div class="panel-item">
                    <input type="checkbox" id="col_height" checked>
                    <label for="col_height">高さ(H)</label>
                </div>
            </div>
        </div>
        <div class="side-panel-footer">
            <button class="panel-close-btn" onclick="toggleSidePanel()">閉じる</button>
        </div>
    </div>

    <!--
        注意: この画面のJavaScriptはsrc/js/search-result-simple.jsに実装されています。
        index.htmlで読み込まれるため、ここにインラインスクリプトは不要です。
    -->

</div>
