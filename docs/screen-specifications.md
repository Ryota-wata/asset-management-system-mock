# 医療機器管理システム 画面設計書

## 目次

1. [ログイン画面](#1-ログイン画面)
2. [資産検索画面（メイン画面）](#2-資産検索画面メイン画面)
3. [個体管理リスト作成モーダル](#3-個体管理リスト作成モーダル)
4. [マスター管理モーダル](#4-マスター管理モーダル)
5. [QRコード管理画面](#5-qrコード管理画面)
6. [QRコード詳細画面](#6-qrコード詳細画面)
7. [QRコード新規発行画面](#7-qrコード新規発行画面)
8. [QRコード印刷画面](#8-qrコード印刷画面)
9. [オフライン準備画面](#9-オフライン準備画面)
10. [現有資産調査画面](#10-現有資産調査画面)
11. [QR読取画面](#11-qr読取画面)
12. [写真撮影・資産番号入力画面](#12-写真撮影資産番号入力画面)
13. [資産情報登録画面（スマートフォン版）](#13-資産情報登録画面スマートフォン版)
14. [資産情報登録画面（タブレット版）](#14-資産情報登録画面タブレット版)
15. [履歴表示画面（スマートフォン版）](#15-履歴表示画面スマートフォン版)
16. [履歴表示画面（タブレット版）](#16-履歴表示画面タブレット版)
17. [登録内容修正画面](#17-登録内容修正画面)
18. [モバイルカラム選択モーダル](#18-モバイルカラム選択モーダル)
19. [写真表示モーダル](#19-写真表示モーダル)

---

## 1. ログイン画面

### 画面ID
`loginPage`

### 目的
システムへのログイン認証を行う

### 対象ユーザー
- コンサルタント
- 病院担当者

### 画面要素

#### 入力項目
| 項目名 | 形式 | 必須 | 備考 |
|--------|------|------|------|
| メールアドレス | email | ○ | メールアドレス形式で入力 |
| パスワード | password | ○ | マスク表示 |
| ログイン情報を記憶する | checkbox | - | チェック時、次回ログイン情報を保持 |

#### ボタン
| ボタン名 | 機能 |
|---------|------|
| ログイン | 認証処理を実行し、資産検索画面へ遷移 |
| パスワードをお忘れの方 | パスワードリセット処理（モックでは未実装） |

### 画面遷移
- **成功時**: 資産検索画面（メイン画面）へ遷移
- **失敗時**: エラーメッセージ表示（モックでは未実装）

### 備考
- 現在の実装では認証処理は行わず、任意の入力で次画面へ遷移可能

---

## 2. 資産検索画面（メイン画面）

### 画面ID
`mainContainer`

### 目的
医療機器・資産の検索条件を設定し、リスト表示を行う

### 対象ユーザー
- コンサルタント（全機能）
- 病院担当者（QRコード管理のみ）

### 画面構成

#### ヘッダー
| 要素 | 表示条件 | 機能 |
|------|---------|------|
| ロゴ | 常時 | システム識別 |
| 個体管理リスト作成 | コンサルタントのみ | 個体管理リスト作成モーダルを表示 |
| マスター管理 | コンサルタントのみ | マスター管理モーダルを表示 |
| ユーザー管理 | コンサルタントのみ | ユーザー管理画面へ遷移（未実装） |
| QRコード管理 | 病院担当者のみ | QRコード管理画面へ遷移 |
| ログアウト | 常時 | ログイン画面へ戻る |

#### 検索条件読み込みエリア
| 要素 | 機能 |
|------|------|
| 保存済み検索条件（ドロップダウン） | 過去に保存した検索条件を選択 |
| 読み込みボタン | 選択した検索条件を適用 |

#### 施設情報セクション
| 項目名 | 入力形式 | データソース | 機能 |
|--------|---------|-------------|------|
| 施設名 | セレクトボックス（検索可） | facility-master.json | 曖昧検索対応 |
| 病床規模 | レンジ選択（From-To） | - | 最小値〜最大値で範囲指定 |
| 部門名 | セレクトボックス（検索可） | facility-master.json | 曖昧検索対応、施設選択後に連動 |
| 部署名 | セレクトボックス（検索可） | facility-master.json | 曖昧検索対応、部門選択後に連動 |

#### 資産情報セクション
| 項目名 | 入力形式 | データソース | 機能 |
|--------|---------|-------------|------|
| category | セレクトボックス | 固定値 | 医療機器/什器備品/システム機器 |
| 大分類 | セレクトボックス（検索可） | asset-master.json | 曖昧検索対応 |
| 中分類 | セレクトボックス（検索可） | asset-master.json | 曖昧検索対応、大分類選択後に連動 |
| 個体管理品目 | セレクトボックス（検索可） | asset-master.json | 曖昧検索対応、中分類選択後に連動 |
| 資産台帳No. | テキスト入力 | - | 任意の番号を入力 |

#### 出力項目（カラム選択）
**基本情報**
- 資産台帳No.（デフォルト選択）
- 機器名称（デフォルト選択）
- メーカー（デフォルト選択）
- 型番（デフォルト選択）

**設備情報**
- 特殊設備（重設備）
- 図面No.
- 幅（W）
- 奥行（D）
- 高さ（H）
- 電源種別
- 電源容量

**システム情報**
- システム接続
- IPアドレス
- MACアドレス

**日付情報**
- 導入日
- 保守契約期限
- リース期限

#### 検索条件保存エリア
| 項目名 | 機能 |
|--------|------|
| 検索条件名入力 | 現在の検索条件に名前を付けて保存 |
| 保存ボタン | 検索条件を保存 |

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 条件クリア | 全ての検索条件をクリア |
| この条件でリスト閲覧する | 検索を実行してリスト表示（未実装） |

### 画面遷移
- **個体管理リスト作成ボタン**: 個体管理リスト作成モーダル表示
- **マスター管理ボタン**: マスター管理モーダル表示
- **QRコード管理ボタン**: QRコード管理画面へ遷移
- **ログアウトボタン**: ログイン画面へ遷移

### レスポンシブ対応
- **スマートフォン**: カラム選択パネルはモーダル表示
- **タブレット以上**: カラム選択パネルは右サイドに固定表示

---

## 3. 個体管理リスト作成モーダル

### 画面ID
`listModal`

### 目的
コンサルタントが各種管理業務を選択するためのメニュー画面

### 対象ユーザー
- コンサルタントのみ

### 画面要素

#### 施設選択
| 項目名 | 入力形式 | データソース | 機能 |
|--------|---------|-------------|------|
| 施設を選択 | セレクトボックス（検索可） | facility-master.json | 曖昧検索対応、Fuse.js使用 |

#### メニューボタン
| ボタン名 | 初期状態 | 遷移先 |
|---------|---------|--------|
| QRコード管理 | 非活性 | QRコード管理画面 |
| 現有品調査 | 非活性 | オフライン準備画面 |
| 現有品調査内容修正 | 非活性 | 登録内容修正画面 |
| 資産台帳取込 | 非活性 | 未実装（アラート表示） |
| データ突合 | 非活性 | 未実装（アラート表示） |

### 動作仕様

#### 施設選択時の挙動
1. 施設未選択時: 全メニューボタンが非活性
2. 施設選択時: 全メニューボタンが活性化
3. 選択解除時: 全メニューボタンが非活性に戻る

#### モーダル表示制御
- **表示トリガー**: 資産検索画面の「個体管理リスト作成」ボタン
- **閉じる方法**:
  - モーダル外の背景部分をクリック
  - ESCキー押下
  - メニューボタンクリック後（画面遷移）
- **位置リセット**: 他画面から戻った際、必ず中央に表示

### 画面遷移
- **QRコード管理**: QRコード管理画面
- **現有品調査**: オフライン準備画面
- **現有品調査内容修正**: 登録内容修正画面
- **資産台帳取込**: アラート表示のみ（未実装）
- **データ突合**: アラート表示のみ（未実装）

---

## 4. マスター管理モーダル

### 画面ID
`masterModal`

### 目的
各種マスタデータの管理画面へアクセス

### 対象ユーザー
- コンサルタントのみ

### 画面要素

#### メニューボタン
| ボタン名 | 遷移先 |
|---------|--------|
| 施設マスタ | 未実装（アラート表示） |
| 資産マスタ | 未実装（アラート表示） |
| 業務マスタ | 未実装（アラート表示） |

### 動作仕様

#### モーダル表示制御
- **表示トリガー**: 資産検索画面の「マスター管理」ボタン
- **閉じる方法**:
  - モーダル外の背景部分をクリック
  - ESCキー押下
  - メニューボタンクリック後
- **位置リセット**: 他画面から戻った際、必ず中央に表示

### 画面遷移
- 全メニュー: アラート表示のみ（未実装）

---

## 5. QRコード管理画面

### 画面ID
`qrPage`

### 目的
QRコードの一覧表示、検索、新規発行、印刷を管理

### 対象ユーザー
- コンサルタント
- 病院担当者

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 資産検索画面へ戻る |
| ロゴ | システム識別 |
| ログアウトボタン | ログイン画面へ遷移 |

#### 検索エリア
| 項目名 | 入力形式 | 備考 |
|--------|---------|------|
| 施設名 | セレクトボックス | - |
| QR番号 | テキスト入力 | 部分一致検索 |
| 資産台帳No. | テキスト入力 | 部分一致検索 |
| 検索ボタン | ボタン | 検索実行 |
| クリアボタン | ボタン | 検索条件クリア |

#### アクションボタン
| ボタン名 | 表示条件 | 機能 |
|---------|---------|------|
| 新規発行 | 常時 | QRコード新規発行画面へ遷移 |
| まとめて印刷 | 1件以上選択時 | 選択したQRコードをまとめて印刷画面へ |
| まとめて削除 | 1件以上選択時 | 選択したQRコードを削除（確認ダイアログ表示） |

#### QRコード一覧テーブル
| カラム名 | 機能 | 備考 |
|---------|------|------|
| チェックボックス | 複数選択 | ヘッダーチェックで全選択/解除 |
| QR番号 | 表示のみ | - |
| 資産台帳No. | 表示のみ | - |
| 機器名称 | 表示のみ | - |
| 発行日 | 表示のみ | YYYY/MM/DD形式 |
| ステータス | 表示のみ | 発行済/印刷済/削除済 |
| 詳細リンク | リンク | QRコード詳細画面へ遷移 |
| 印刷リンク | リンク | QRコード印刷画面へ遷移 |

#### ページネーション
- 1ページあたり: 20件表示
- ページ番号表示
- 前へ/次へボタン

### 画面遷移
- **戻るボタン**: 資産検索画面
- **新規発行ボタン**: QRコード新規発行画面
- **まとめて印刷ボタン**: QRコード印刷画面
- **詳細リンク**: QRコード詳細画面
- **印刷リンク**: QRコード印刷画面
- **ログアウトボタン**: ログイン画面

---

## 6. QRコード詳細画面

### 画面ID
`qrDetailPage`

### 目的
個別QRコードの詳細情報を表示・編集

### 対象ユーザー
- コンサルタント
- 病院担当者

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | QRコード管理画面へ戻る |
| タイトル | 「QRコード詳細 - QR番号」を表示 |

#### QRコード表示エリア
- QRコード画像（中央配置）
- QR番号
- 発行日時

#### 資産情報エリア
| 項目名 | 表示形式 |
|--------|---------|
| 資産台帳No. | テキスト |
| 機器名称 | テキスト |
| メーカー | テキスト |
| 型番 | テキスト |
| 設置場所 | テキスト |
| 導入日 | テキスト（YYYY/MM/DD） |

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 印刷 | QRコード印刷画面へ遷移 |
| 編集 | 編集モード切替（未実装） |
| 削除 | QRコード削除（確認ダイアログ表示） |

### 画面遷移
- **戻るボタン**: QRコード管理画面
- **印刷ボタン**: QRコード印刷画面

---

## 7. QRコード新規発行画面

### 画面ID
`qrIssuePage`

### 目的
新しいQRコードを発行する

### 対象ユーザー
- コンサルタント
- 病院担当者

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | QRコード管理画面へ戻る |
| タイトル | 「QRコード新規発行」 |

#### 発行方法選択
| 選択肢 | 説明 |
|--------|------|
| 資産台帳から選択 | 既存の資産台帳から選択して発行 |
| 手動入力 | 新規に情報を入力して発行 |

#### 入力フォーム（手動入力選択時）
| 項目名 | 入力形式 | 必須 |
|--------|---------|------|
| 資産台帳No. | テキスト | ○ |
| 機器名称 | テキスト | ○ |
| メーカー | テキスト | - |
| 型番 | テキスト | - |
| 設置場所 | テキスト | - |

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| キャンセル | QRコード管理画面へ戻る（入力内容破棄） |
| 発行 | QRコード発行処理を実行 |

### 画面遷移
- **戻るボタン**: QRコード管理画面
- **キャンセルボタン**: QRコード管理画面
- **発行ボタン**: QRコード管理画面（発行完了メッセージ表示）

---

## 8. QRコード印刷画面

### 画面ID
`qrPrintPage`

### 目的
QRコードを印刷プレビューして印刷実行

### 対象ユーザー
- コンサルタント
- 病院担当者

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 呼び出し元画面へ戻る（QRコード管理 or QRコード詳細） |
| タイトル | 「QRコード印刷プレビュー」 |

#### 印刷設定エリア
| 項目名 | 選択肢 | デフォルト |
|--------|--------|----------|
| 用紙サイズ | A4/A5/はがき | A4 |
| 印刷レイアウト | 1列/2列/3列 | 2列 |
| QRサイズ | 小/中/大 | 中 |

#### プレビューエリア
- 選択したQRコードを印刷レイアウトでプレビュー表示
- QRコード画像
- QR番号
- 資産台帳No.
- 機器名称

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 印刷実行 | ブラウザ印刷ダイアログを表示 |
| キャンセル | 呼び出し元画面へ戻る |

### 画面遷移
- **戻るボタン**:
  - QRコード一覧から呼び出された場合 → QRコード管理画面
  - QRコード詳細から呼び出された場合 → QRコード詳細画面
- **キャンセルボタン**: 呼び出し元画面へ戻る

### 備考
- `window.qrPrintFromPage` 変数で呼び出し元を判定

---

## 9. オフライン準備画面

### 画面ID
`offlinePrepPage`

### 目的
現地調査のためのオフライン作業準備を行う

### 対象ユーザー
- コンサルタントのみ

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 資産検索画面へ戻る（個体管理リストモーダルは閉じる） |
| タイトル | 「オフライン準備」 |

#### 施設情報表示
| 項目名 | 表示形式 |
|--------|---------|
| 選択施設名 | テキスト（読み取り専用） |
| 病床数 | テキスト（読み取り専用） |
| 住所 | テキスト（読み取り専用） |

#### データダウンロードエリア
| 項目名 | 機能 |
|--------|------|
| 資産マスタダウンロード | 施設の資産マスタをダウンロード（未実装） |
| QRコードリストダウンロード | QRコード一覧をダウンロード（未実装） |
| 過去調査データダウンロード | 前回調査データをダウンロード（未実装） |

#### 注意事項表示
- オフライン作業時の注意点を表示
- データ同期のタイミング説明
- バックアップの推奨

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 準備完了・調査開始 | 現有資産調査画面へ遷移 |

### 画面遷移
- **戻るボタン**: 資産検索画面
- **準備完了・調査開始ボタン**: 現有資産調査画面

---

## 10. 現有資産調査画面

### 画面ID
`surveyPage`

### 目的
現地で資産を調査・登録するためのメイン画面

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- タブレット
- スマートフォン

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | オフライン準備画面へ戻る |
| タイトル | 「現有資産調査」 |
| 施設名表示 | 選択中の施設名 |

#### 調査情報入力エリア
| 項目名 | 入力形式 | データソース | 機能 |
|--------|---------|-------------|------|
| Category | セレクトボックス（検索・フリー入力可） | マスタ | Choices.js使用 |
| 棟 | セレクトボックス（検索・フリー入力可） | マスタ | Choices.js使用 |
| 階 | セレクトボックス（検索・フリー入力可） | マスタ | Choices.js使用 |
| 部門 | セレクトボックス（検索・フリー入力可） | マスタ | Choices.js使用 |
| 部署 | セレクトボックス（検索・フリー入力可） | マスタ | Choices.js使用 |

#### フリー入力機能
- 各セレクトボックスでフリー入力が可能
- マスタにない値を入力してEnterキーで追加
- 追加した値は選択肢に反映

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 次へ（QR読取） | QR読取画面へ遷移 |

### 画面遷移
- **戻るボタン**: オフライン準備画面
- **次へボタン**: QR読取画面

---

## 11. QR読取画面

### 画面ID
`qrScanPage`

### 目的
QRコードをカメラで読み取り、資産を特定

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- タブレット
- スマートフォン

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 現有資産調査画面へ戻る |
| タイトル | 「QRコード読取」 |

#### カメラプレビューエリア
- デバイスのカメラ映像を表示
- QRコード読取フレーム表示
- 読取ガイド表示

#### 読取状態表示
| 状態 | 表示内容 |
|------|---------|
| 待機中 | 「QRコードをかざしてください」 |
| 読取中 | 「読み取っています...」 |
| 成功 | 「読み取り成功」（QR番号表示） |
| 失敗 | 「読み取り失敗」（エラーメッセージ） |

#### アクションボタン
| ボタン名 | 表示条件 | 機能 |
|---------|---------|------|
| 次へ | 読取成功時 | 写真撮影・資産番号入力画面へ遷移 |
| 再読取 | 読取失敗時 | カメラを再起動 |
| QRなしで続行 | 常時 | QRコードなしで次画面へ |

### 画面遷移
- **戻るボタン**: 現有資産調査画面
- **次へボタン**: 写真撮影・資産番号入力画面

---

## 12. 写真撮影・資産番号入力画面

### 画面ID
`photoInputPage`

### 目的
資産の写真撮影と資産番号の入力を行う

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- タブレット
- スマートフォン

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | QR読取画面へ戻る |
| タイトル | 「写真撮影・資産番号入力」 |

#### QR情報表示（QR読取済みの場合）
| 項目名 | 表示形式 |
|--------|---------|
| QR番号 | テキスト（読み取り専用） |
| 資産台帳No. | テキスト（読み取り専用） |

#### 写真撮影エリア
| 要素 | 機能 |
|------|------|
| カメラプレビュー | デバイスカメラの映像表示 |
| 撮影ボタン | 写真を撮影（最大6枚まで） |
| 撮影済み写真サムネイル | 撮影した写真を表示 |
| 削除ボタン | 各写真に削除ボタン表示 |

#### 資産番号入力（QR未読取の場合）
| 項目名 | 入力形式 | 必須 |
|--------|---------|------|
| 資産台帳No. | テキスト入力 | ○ |

#### アクションボタン
| ボタン名 | 活性条件 | 機能 |
|---------|---------|------|
| 次へ | 写真1枚以上撮影 OR 資産番号入力済み | 資産情報登録画面へ遷移 |

### 画面遷移
- **戻るボタン**: QR読取画面
- **次へボタン**: 資産情報登録画面（デバイスサイズで分岐）
  - 画面幅 ≤ 768px: スマートフォン版
  - 画面幅 > 768px: タブレット版

---

## 13. 資産情報登録画面（スマートフォン版）

### 画面ID
`assetInfoSmartphonePage`

### 目的
撮影した資産の詳細情報を登録（スマートフォン最適化）

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- スマートフォン（画面幅 ≤ 768px）

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 写真撮影・資産番号入力画面へ戻る |
| タイトル | 「資産情報登録」 |

#### 資産基本情報表示
| 項目名 | 表示形式 |
|--------|---------|
| 資産台帳No. | テキスト（読み取り専用） |
| 撮影日時 | テキスト（自動取得） |
| 撮影写真 | サムネイル一覧（タップで拡大） |

#### 入力フォーム（縦スクロール最適化）
| セクション | 項目 | 入力形式 | データソース |
|-----------|------|---------|-------------|
| 分類情報 | 大分類 | セレクト（検索・フリー入力可） | マスタ |
| | 中分類 | セレクト（検索・フリー入力可） | マスタ |
| | 個体管理品目 | セレクト（検索・フリー入力可） | マスタ |
| 製造元情報 | メーカー | セレクト（検索・フリー入力可） | マスタ |
| | 型番 | セレクト（検索・フリー入力可） | マスタ |
| 設置情報 | 棟 | テキスト（前画面から引き継ぎ） | - |
| | 階 | テキスト（前画面から引き継ぎ） | - |
| | 部門 | テキスト（前画面から引き継ぎ） | - |
| | 部署 | テキスト（前画面から引き継ぎ） | - |

#### アクションボタン（画面下部固定）
| ボタン名 | 機能 |
|---------|------|
| 履歴を見る | 履歴表示画面（スマホ版）へ遷移 |
| 部門入力へ | 現有資産調査画面へ戻る（次の資産登録） |
| 保存 | データ保存（未実装） |

### 画面遷移
- **戻るボタン**: 写真撮影・資産番号入力画面
- **履歴を見るボタン**: 履歴表示画面（スマホ版）
- **部門入力へボタン**: 現有資産調査画面

---

## 14. 資産情報登録画面（タブレット版）

### 画面ID
`assetInfoTabletPage`

### 目的
撮影した資産の詳細情報を登録（タブレット最適化）

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- タブレット（画面幅 > 768px）

### 画面構成

#### レイアウト
- 左側: 資産情報入力フォーム
- 右側: 撮影写真プレビュー

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 写真撮影・資産番号入力画面へ戻る |
| タイトル | 「資産情報登録」 |

#### 左側エリア - 入力フォーム
| セクション | 項目 | 入力形式 | データソース |
|-----------|------|---------|-------------|
| 基本情報 | 資産台帳No. | テキスト（読み取り専用） | - |
| | 撮影日時 | テキスト（読み取り専用） | - |
| 分類情報 | 大分類 | セレクト（検索・フリー入力可） | マスタ |
| | 中分類 | セレクト（検索・フリー入力可） | マスタ |
| | 個体管理品目 | セレクト（検索・フリー入力可） | マスタ |
| 製造元情報 | メーカー | セレクト（検索・フリー入力可） | マスタ |
| | 型番 | セレクト（検索・フリー入力可） | マスタ |
| 設置情報 | 棟 | テキスト（前画面から引き継ぎ） | - |
| | 階 | テキスト（前画面から引き継ぎ） | - |
| | 部門 | テキスト（前画面から引き継ぎ） | - |
| | 部署 | テキスト（前画面から引き継ぎ） | - |

#### 右側エリア - 写真プレビュー
- 撮影写真を大きく表示
- 写真間の切り替えボタン
- 拡大表示機能

#### アクションボタン（画面下部）
| ボタン名 | 機能 |
|---------|------|
| 履歴を見る | 履歴表示画面（タブレット版）へ遷移 |
| 部門入力へ | 現有資産調査画面へ戻る（次の資産登録） |
| 保存 | データ保存（未実装） |

### 画面遷移
- **戻るボタン**: 写真撮影・資産番号入力画面
- **履歴を見るボタン**: 履歴表示画面（タブレット版）
- **部門入力へボタン**: 現有資産調査画面

---

## 15. 履歴表示画面（スマートフォン版）

### 画面ID
`historyListSmartphonePage`

### 目的
登録済み資産の履歴を一覧表示（スマートフォン最適化）

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- スマートフォン（画面幅 ≤ 768px）

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 資産情報登録画面（スマホ版）へ戻る |
| タイトル | 「登録履歴」 |

#### フィルターエリア
| 項目名 | 入力形式 |
|--------|---------|
| 資産台帳No. | テキスト検索 |
| 登録日 | 日付範囲指定 |

#### 履歴リスト（カード形式）
各カードの表示内容：
| 項目名 | 表示形式 |
|--------|---------|
| 資産台帳No. | テキスト |
| 機器名称 | テキスト |
| 登録日時 | テキスト（YYYY/MM/DD HH:mm） |
| 撮影枚数 | テキスト |
| サムネイル | 代表写真1枚 |
| 詳細ボタン | ボタン（未実装） |

#### ページネーション
- 10件ごとに表示
- 「もっと見る」ボタンで追加読み込み

### 画面遷移
- **戻るボタン**: 資産情報登録画面（スマホ版）
- **詳細ボタン**: 詳細表示（未実装）

---

## 16. 履歴表示画面（タブレット版）

### 画面ID
`historyListTabletPage`

### 目的
登録済み資産の履歴を一覧表示（タブレット最適化）

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- タブレット（画面幅 > 768px）

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 資産情報登録画面（タブレット版）へ戻る |
| タイトル | 「登録履歴」 |

#### フィルターエリア（上部）
| 項目名 | 入力形式 |
|--------|---------|
| 資産台帳No. | テキスト検索 |
| 機器名称 | テキスト検索 |
| 登録日（From） | 日付選択 |
| 登録日（To） | 日付選択 |
| 検索ボタン | ボタン |
| クリアボタン | ボタン |

#### 履歴テーブル
| カラム名 | 表示形式 | ソート |
|---------|---------|--------|
| 資産台帳No. | テキスト | ○ |
| 機器名称 | テキスト | ○ |
| メーカー | テキスト | - |
| 型番 | テキスト | - |
| 登録日時 | テキスト（YYYY/MM/DD HH:mm） | ○ |
| 写真 | サムネイル | - |
| 操作 | ボタン（詳細/編集/削除） | - |

#### ページネーション
- 20件ごとに表示
- ページ番号選択
- 前へ/次へボタン

### 画面遷移
- **戻るボタン**: 資産情報登録画面（タブレット版）
- **詳細ボタン**: 詳細表示（未実装）

---

## 17. 登録内容修正画面

### 画面ID
`registrationEditPage`

### 目的
現有品調査で登録した内容を一覧表示し、編集・削除を行う

### 対象ユーザー
- コンサルタントのみ

### 対応デバイス
- PC
- タブレット

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| 戻るボタン | 資産検索画面へ戻る（個体管理リストモーダルは閉じる） |
| タイトル | 「登録内容修正」 |
| 施設名表示 | 選択中の施設名 |

#### フィルターエリア
| 項目名 | 入力形式 | データソース |
|--------|---------|-------------|
| 棟 | セレクトボックス（検索可） | 登録データから生成 |
| 階 | セレクトボックス（検索可） | 登録データから生成 |
| 部門 | セレクトボックス（検索可） | 登録データから生成 |
| 部署 | セレクトボックス（検索可） | 登録データから生成 |
| Category | セレクトボックス（検索可） | 登録データから生成 |
| 大分類 | セレクトボックス（検索可） | 登録データから生成 |
| 中分類 | セレクトボックス（検索可） | 登録データから生成 |

#### 登録内容テーブル
| カラム名 | 表示形式 | 編集可否 |
|---------|---------|---------|
| チェックボックス | チェックボックス | - |
| 資産台帳No. | テキスト | ○ |
| Category | テキスト | ○ |
| 棟 | テキスト | ○ |
| 階 | テキスト | ○ |
| 部門 | テキスト | ○ |
| 部署 | テキスト | ○ |
| 大分類 | テキスト | ○ |
| 中分類 | テキスト | ○ |
| 個体管理品目 | テキスト | ○ |
| 写真 | サムネイル | - |
| 操作 | ボタン | - |

#### テーブル内編集機能
- **インライン編集**: セルをクリックで編集モード
- **一括編集**: チェックボックスで複数選択後、一括更新
- **写真表示**: サムネイルクリックで写真モーダル表示

#### アクションボタン
| ボタン名 | 表示条件 | 機能 |
|---------|---------|------|
| 選択行を削除 | 1件以上選択時 | 選択行を削除（確認ダイアログ） |
| 変更を保存 | 編集内容がある時 | 変更内容を保存 |
| エクスポート | 常時 | CSV/Excel形式でエクスポート（未実装） |

### 画面遷移
- **戻るボタン**: 資産検索画面

---

## 18. モバイルカラム選択モーダル

### 画面ID
`mobileColumnModal`

### 目的
スマートフォン表示時に出力項目を選択する

### 対象ユーザー
- コンサルタント
- 病院担当者

### 対応デバイス
- スマートフォン（画面幅 ≤ 768px）

### 画面構成

#### ヘッダー
| 要素 | 機能 |
|------|------|
| タイトル | 「出力項目選択」 |
| 閉じるボタン | モーダルを閉じる |

#### カラム選択リスト
資産検索画面と同じ項目をリスト表示：
- 基本情報（4項目）
- 設備情報（7項目）
- システム情報（3項目）
- 日付情報（3項目）

#### アクションボタン
| ボタン名 | 機能 |
|---------|------|
| 全て選択 | 全項目を選択 |
| 全て解除 | 全項目の選択を解除 |
| 適用 | 選択内容を反映してモーダルを閉じる |

### 動作仕様
- モーダル外クリックで閉じる
- 選択状態は資産検索画面と同期

---

## 19. 写真表示モーダル

### 画面ID
`photoModal`

### 目的
登録された写真を拡大表示

### 対象ユーザー
- コンサルタント
- 病院担当者

### 対応デバイス
- 全デバイス

### 画面構成

#### モーダルヘッダー
| 要素 | 機能 |
|------|------|
| タイトル | 「写真プレビュー」 |
| 別ウィンドウで開くボタン | 新しいウィンドウで全写真を表示 |
| 閉じるボタン | モーダルを閉じる |
| ドラッグハンドル | モーダル位置を移動可能 |

#### 写真表示エリア
- グリッドレイアウトで複数写真を表示
- 各写真をクリックで個別拡大（未実装）
- 最大表示枚数: 制限なし

#### 操作機能
- **ドラッグ移動**: ヘッダーをドラッグしてモーダル位置を変更
- **別ウィンドウ表示**: 全写真を新しいウィンドウで表示

### 動作仕様
- ヘッダー以外をクリックしてもモーダルは閉じない
- ドラッグ位置は保持される
- 閉じるボタンまたは背景クリックで閉じる

---

## 共通仕様

### レスポンシブ対応

#### ブレークポイント
| デバイス | 画面幅 | 適用 |
|---------|--------|------|
| スマートフォン | 〜768px | モバイル専用レイアウト |
| タブレット | 769px〜1024px | タブレット最適化レイアウト |
| PC | 1025px〜 | デスクトップレイアウト |

### データソース

#### マスタデータファイル
| ファイル名 | 内容 |
|-----------|------|
| src/data/facility-master.json | 施設、部門、部署マスタ |
| src/data/asset-master.json | 大分類、中分類、品目、メーカー、型番マスタ |

### 共通操作

#### Choices.js（セレクトボックス強化）
- **曖昧検索**: Fuse.jsによるファジー検索
- **フリー入力**: マスタにない値を入力可能（画面により異なる）
- **キーボード操作**: 矢印キーで選択、Enterで決定

#### モーダル操作
- **表示**: 各画面のボタンクリック
- **閉じる方法**:
  - 閉じるボタン
  - 背景クリック
  - ESCキー
- **位置リセット**: 再表示時に中央配置

### エラーハンドリング

#### 画面表示エラー
- HTMLファイル読み込み失敗時: コンソールエラー表示

#### マスタデータ読み込みエラー
- JSONファイル読み込み失敗時: コンソールエラー表示、ドロップダウンに「読み込み中...」表示

#### 未実装機能
- 未実装機能クリック時: アラートメッセージ表示

---

## 今後の実装予定

### 機能追加
1. **検索実行機能**: 資産検索画面での検索処理
2. **データ保存機能**: 資産情報の実際の保存処理
3. **エクスポート機能**: CSV/Excel形式でのデータ出力
4. **ユーザー管理**: ユーザー登録・編集・削除機能
5. **マスタ管理**: 各種マスタデータのCRUD機能

### 画面追加
1. **ユーザー管理画面**: ユーザーのCRUD操作
2. **施設マスタ管理画面**: 施設情報の編集
3. **資産マスタ管理画面**: 資産分類の編集
4. **業務マスタ管理画面**: 業務関連マスタの編集

### 機能改善
1. **オフライン対応**: Service Workerによる完全オフライン動作
2. **データ同期**: オンライン復帰時の自動同期
3. **バリデーション強化**: 入力値チェックの追加
4. **パフォーマンス最適化**: 大量データ表示時の仮想スクロール実装
